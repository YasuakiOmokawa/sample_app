<script type="text/javascript">
var arr = [], arr2 = [], arr1 = [];
gon.homearr.forEach(
    function(value){
    arr1.push( [ value[0], value[1], value[2], value[3] ] )
  }
);
arr.push(arr1);

var arr_org = [
    [
      [ 0, 65, 10, 'PV数 全体' ],
      [ 30, 22, 10, '平均PV数' ],
      [ 300, 91, 10, '訪問回数' ],
      [ 78, 79, 10, '曜日別' ],
      [ 600, 79, 10, '平均滞在時間' ],
      [ 100.0, 79, 10, '人気ページ' ],
      [ 50.0, 63, 10, '直帰率' ],
      [ 21.0, 91, 10, '再訪問率' ],
      [ 15.0, 54, 10, '新規訪問率' ],
    ]
];


jQuery( function() {

   // バブル（散布図）チャート相関グラフ
   // x軸, y軸, 大きさ(radius), 項目名　の順に表示
   // 今回は x ... GAP y ... 相関　で現す。
  // GAP値は数値、時間、パーセンテージでばらつきがあるため、
  // パーセンテージを実数へ変換する。

  // jqplot描画後に実行する操作（jqplot描画前に書くこと）
  $.jqplot.postDrawHooks.push(function(square) {
    var selcts = [ $('.jqplot-xaxis-tick'), $('.jqplot-yaxis-tick') ];
    for (var i=0; i<selcts.length; i++) {
      $(selcts[i][0]).text('小');
      $(selcts[i][1]).text('');
      $(selcts[i][2]).text('大');
    }
  });

  // グラフ描画オプション
  var options = {
    seriesDefaults: {
      renderer: jQuery.jqplot.BubbleRenderer,
      rendererOptions: {
        bubbleAlpha: 0.6,
        highlightAlpha: 0.8,
        showLabels: false,
        varyBubbleColors: false,
        autoscaleMultiplier: 0.3,
      },
    },
    series:[
          // １つ目の項目の設定
        {
            color: 'gray',
        },
          // ２つ目の項目の設定
        {
            color: 'blue',
        },
    ],
    axesDefaults: {
      // showTicks: false,
      numberTicks: 3,
      tickOptions: {
        fontSize: '10pt',
        fontFamily: 'ヒラギノ角ゴ Pro W3',
      },
    },
    axes: {
      xaxis: {
        label: 'GAP',
        min: 0,
        tickOptions: {
        },
      },
      yaxis: {
        label: '相関',
        min: 0,
        max: 100,
        tickOptions: {
        },
      },
    },
  };

  // jqplot描画
  var square = jQuery . jqplot('square', arr, options);

  // 凡例の描画
  $.each(arr, function(index, val) {
    $('#legend1b').append('<tr><td>'+val[3]+'</td><td>'+val[2]+'</td></tr>');
  });

  // ハイライトツールチップを表示
  $('#square').bind('jqplotDataHighlight',
    function (ev, seriesIndex, pointIndex, data, radius) {
      var
        chart_left = $('#square').offset().left,
        chart_top = $('#square').offset().top,
        x = square.axes.xaxis.u2p(data[0]),  // convert x axis unita to pixels
        y = square.axes.yaxis.u2p(data[1]);  // convert y axis units to pixels
      var color = 'black';
      var tab = '全体';
      var page = 'li.tab > a:contains(' + tab + ')';
      var name = $(page)[0].name;
      $('#tooltip1s').css({left:chart_left+x+radius + -5, top:chart_top+y});
      $('#tooltip1s').html(
          '<a href="#" id="abtn" name=' + name
          + ' style="font-size:14px;' +
          'font-weight:bold;color:' + color + ';background-color: whitesmoke;">'
          + tab + '&nbsp;'
          + data[3] + '<br>'
          + '</a>'
          // 'x: ' + data[0] +'<br />' +
          // 'y: ' + data[1] + '<br />'
        );
      $('#tooltip1s').show();
      // ハイライトツールチップへリンク付与
      $('#abtn').click(function() {
        evtset($(this));
      });
      // $('#legend1b tr').css('background-color', '#ffffff');
      // $('#legend1b tr').eq(pointIndex+1).css('background-color', color);
    }
  );

  // ハイライトツールチップを隠す
  $('#square').bind('jqplotDataUnhighlight',
      function (ev, seriesIndex, pointIndex, data) {
          $('#tooltip1s').empty();
          $('#tooltip1s').hide();
          // $('#legend1b tr').css('background-color', '#ffffff');
      }
  );
});


</script>
